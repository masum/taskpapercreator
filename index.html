<html ng-app="app">
<meta charset="utf-8"/>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>

<style>
.content {
  background-color:red;
}
.paper {
  width: 65mm;
  height: 65mm;
  border: 1.5mm solid #000000;
  border-radius: 5mm;
  -webkit-border-radius: 5mm;
  -moz-border-radius: 5mm;
  font-family: "Hiragino Kaku Gothic ProN","メイリオ", sans-serif;
  font-size: 5mm;
  position:relative;
  float:left;
}
.id {
  font-size: 16mm;
  font-weight: bold;
  text-align: center;
  border-bottom: 1.2mm solid #000000;
  text-shadow: 5px 5px 1px #999999;
  line-height: 20mm;
}
.category {
  text-align:center;
}
.category span {
  padding: 4px 10px;
  border-radius: 5mm;
  -webkit-border-radius: 5mm;
  -moz-border-radius: 5mm;
  font-weight: bold;
}
.c0 span {
  background-color: #ff6666;
}
.c1 span {
  background-color: #007700;
  color: #ffffff;
}
.c2 span {
  background-color: #3333aa;
  color: #ffffff;
}
.c3 span {
  background-color: #00ff77;
  color: black;
}
.c4 span {
  background-color: #aa33aa;
  color: #ffffff;
}
.summary {
  font-size:6mm;
  padding: 1mm;
  line-height: 1.0em;
  height: 27mm;
  overflow:hidden;
}
.yellow {
  background-color: #ffff00;
}
.red {
  background-color: #ff0000;
}
.orange {
  background-color: #ffa500;
}
.info {
  padding: 0 10px;
  border-top: 1px solid #666;
  font-size:0.7em;
}
.time {
  position:absolute;
  font-weight: bold;
  color: #660000;
  text-shadow: 5px 5px 1px #999999;
  font-size:10mm;
  top: 50mm;
  left: 46mm;
}
.page {
  top:0 !IMPORTANT;
  left:0 !IMPORTANT;
  height:200mm !IMPORTANT;
  width:290mm !IMPORTANT;
  clear: both;
  page-break-after:auto;
}
#input {
  margin: 10px 0px;
}
#input textarea {
  width:100%;
  height: 100px;
}
@media print{
  .noprint {
    display: none;
  }
}
</style>
<script>
/*
category,1234,サマリー,1
category,1234,サマリー,20
category1,1234,サマリー,30
category,1234,サマリー,40
 */
var categories = [];
function categoryNo(c) {
  var p = categories.indexOf(c)
  if (p != -1) {
    return p;
  } else {
    categories.push(c);
    return categories.length -1;
  }
}
var app = angular.module('app', []);
app.controller('taskpaper', ['$scope', function($scope){
  $scope.start = function() {
    $scope.data = [];
    $scope.data[0] = [];
    var lines = $scope.input.split('\n');
    for (var i=0;i<lines.length;i++) {
      var fields = lines[i].split(',');
      var item = {};
      var cat = fields[0];
      var catNo = categoryNo(cat);

      item['category'] = cat;
      item['id'] = fields[1];
      item['summary'] = fields[2];
      item['time'] = fields[3];
      item['style_background'] = "yellow";
      item['style_category'] = "c" + catNo;
      console.log(JSON.stringify(item));
      $scope.data[0].push(item);
    }
  }
}]);

</script>
<div ng-controller="taskpaper">
  <div class="noprint">
  <span>カテゴリ、チケットＩＤ、サマリー、見積時間</span>
  <div id="input" class="text-center">
    <textarea id="input_data" ng-model="input"></textarea><br>
    <button ng-click="start()" class="btn btn-primary btn-lg">作成</button>
  </div>
</div>
  <div ng-repeat="page in data" class="page">
    <div ng-repeat="item in page">
      <div class="paper {{item.style_background}}">
        <div class="id">#{{item.id}}</div>
        <div class="category {{item.style_category}}"><span>{{item.category}}</span></div>
        <div class="summary">{{item.summary}}</div>
        <div class="info">
          担当:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;実施日:
        </div>
        <div class="time">{{item.time}}</div>
      </div>
    </div>
  </div>
</div>
</html>
